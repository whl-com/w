<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="logo-simple.svg" type="image/svg+xml">
    <title>åº—é“º - æ‰“å°æ¨¡æ¿ç¼–è¾‘å™¨</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="print-optimization.css">
    <link rel="stylesheet" href="mobile-fix.css">
    <link rel="stylesheet" href="mobile-properties-fix.css">
    <style>
        /* Wordé£æ ¼ç¼–è¾‘å™¨å·¥å…·æ æ ·å¼ */
        .editor-toolbar {
            background: #34495e;
            padding: 10px 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            border-bottom: 1px solid #2c3e50;
        }
        
        .tool-group {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            background: #3b4b5b;
            border-radius: 6px;
        }
        
        .editor-btn {
            background: #4a6572;
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }
        
        .editor-btn:hover {
            background: #546e7a;
        }
        
        .editor-btn.active {
            background: #1976d2;
        }
        
        .editor-select, .editor-input {
            padding: 6px 8px;
            border: 1px solid #546e7a;
            border-radius: 4px;
            background: #2c3e50;
            color: white;
        }
        
        /* é¡µé¢æ§åˆ¶ */
        .page-controls {
            padding: 15px 20px;
            background: #ecf0f1;
            border-bottom: 1px solid #bdc3c7;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-size-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 5px;
        }
        
        .page-size-btn.active {
            background: #2980b9;
        }
        
        /* ç¼–è¾‘å™¨åŒºåŸŸ */
        .editor-area {
            flex: 1;
            padding: 20px;
            overflow: auto;
            background: #fafafa;
            position: relative;
        }
        
        .page {
            background: white;
            min-height: 842px;
            width: 595px;
            margin: 0 auto;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border: 1px solid #ddd;
        }
        
        .page.landscape {
            width: 842px;
            min-height: 595px;
        }
        
        .editable-content {
            min-height: 400px;
            outline: none;
            line-height: 1.6;
            font-size: 14px;
        }
        
        .editable-content:focus {
            border: none;
            outline: none;
        }
        
        /* æ‰“å°é¢„è§ˆ */
        .print-preview {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .print-preview-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
        }
        
        @media print {
            .header, .editor-toolbar, .properties-panel, .page-controls {
                display: none !important;
            }
            
            .main-content {
                margin: 0;
                padding: 0;
            }
            
            .template-container {
                margin: 0;
                border-radius: 0;
                box-shadow: none;
            }
            
            .page {
                box-shadow: none;
                border: none;
                margin: 0;
                width: 100% !important;
                height: 100% !important;
            }
        }
        
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .editor-toolbar {
                padding: 8px 12px;
                gap: 8px;
            }
            
            .tool-group {
                padding: 3px 8px;
            }
            
            .editor-area {
                padding: 15px;
            }
            
            .page {
                width: 100%;
                min-height: auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>æ‰“å°æ¨¡æ¿ç¼–è¾‘å™¨</h1>
            <div class="toolbar">
                <button id="addText" class="tool-btn">æ·»åŠ æ–‡æœ¬</button>
                <button id="addImage" class="tool-btn">æ·»åŠ å›¾ç‰‡</button>
                <button id="scanText" class="tool-btn">æ‰«æè¯†åˆ«</button>
                <button id="saveTemplate" class="tool-btn">ä¿å­˜æ¨¡æ¿</button>
                <button id="loadTemplate" class="tool-btn">åŠ è½½æ¨¡æ¿</button>
                <button id="print" class="tool-btn primary">æ‰“å°é¢„è§ˆ</button>
            </div>
        </header>

        <!-- Wordé£æ ¼ç¼–è¾‘å™¨å·¥å…·æ  -->
        <div class="editor-toolbar">
            <div class="tool-group">
                <select id="fontFamily" class="editor-select">
                    <option value="Microsoft YaHei">å¾®è½¯é›…é»‘</option>
                    <option value="SimSun">å®‹ä½“</option>
                    <option value="SimHei">é»‘ä½“</option>
                    <option value="KaiTi">æ¥·ä½“</option>
                    <option value="Arial">Arial</option>
                </select>
                
                <select id="fontSize" class="editor-select">
                    <option value="1">8px</option>
                    <option value="2">10px</option>
                    <option value="3" selected>12px</option>
                    <option value="4">14px</option>
                    <option value="5">18px</option>
                    <option value="6">24px</option>
                </select>
            </div>
            
            <div class="tool-group">
                <button id="boldBtn" class="editor-btn" title="åŠ ç²—"><b>B</b></button>
            </div>
            
            <div class="tool-group">
                <button id="alignLeft" class="editor-btn" title="å·¦å¯¹é½">â¬…ï¸</button>
                <button id="alignCenter" class="editor-btn" title="å±…ä¸­">ğŸ”˜</button>
                <button id="alignRight" class="editor-btn" title="å³å¯¹é½">â¡ï¸</button>
            </div>
        </div>

        <!-- é¡µé¢æ§åˆ¶ -->
        <div class="page-controls">
            <div>
                <span>é¡µé¢è®¾ç½®: </span>
                <button id="portraitBtn" class="page-size-btn active">ç«–ç‰ˆ A4</button>
                <button id="landscapeBtn" class="page-size-btn">æ¨ªç‰ˆ A4</button>
            </div>
            <div>
                <span>ç¼©æ”¾: </span>
                <select id="zoomLevel" class="editor-select" onchange="setZoom(this.value)">
                    <option value="0.8">80%</option>
                    <option value="1" selected>100%</option>
                    <option value="1.2">120%</option>
                </select>
            </div>
        </div>

        <main class="main-content">
            <div class="template-container">
                <div class="editor-area">
                    <div class="page" id="page">
                        <div 
                            class="editable-content" 
                            id="editor" 
                            contenteditable="true"
                            oninput="updateStatus()"
                        >
                            <h1 style="text-align: center; color: #2c3e50;">æ‰“å°æ¨¡æ¿ç¼–è¾‘å™¨</h1>
                            <p style="text-align: center; color: #7f8c8d;">åœ¨æ­¤å¤„ç¼–è¾‘æ‚¨çš„æ‰“å°æ¨¡æ¿å†…å®¹</p>
                            
                            <hr style="margin: 30px 0; border: 1px solid #ecf0f1;">
                            
                            <h2>ä½¿ç”¨è¯´æ˜</h2>
                            <ul>
                                <li>ç›´æ¥ç‚¹å‡»æ–‡æœ¬è¿›è¡Œç¼–è¾‘</li>
                                <li>ä½¿ç”¨å·¥å…·æ è®¾ç½®å­—ä½“ã€å¤§å°ã€åŠ ç²—å’Œå¯¹é½æ–¹å¼</li>
                                <li>æ”¯æŒæ¨ªç‰ˆå’Œç«–ç‰ˆæ‰“å°</li>
                                <li>ä½¿ç”¨å·¦ä¾§æŒ‰é’®æ·»åŠ æ–‡æœ¬å’Œå›¾ç‰‡å…ƒç´ </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div class="properties-panel" id="propertiesPanel">
            <h3>å±æ€§è®¾ç½®</h3>
            
            <!-- æ–‡æœ¬å…ƒç´ å±æ€§ -->
            <div id="textProperties" class="element-properties">
                <div class="property-group">
                    <label>å†…å®¹:</label>
                    <textarea id="contentInput" placeholder="è¾“å…¥å†…å®¹..."></textarea>
                </div>
                <div class="property-group">
                    <label>å­—ä½“å¤§å°:</label>
                    <input type="number" id="fontSizeInput" value="14" min="8" max="72">
                </div>
                <div class="property-group">
                    <label>å¯¹é½æ–¹å¼:</label>
                    <select id="alignInput">
                        <option value="left">å·¦å¯¹é½</option>
                        <option value="center">å±…ä¸­</option>
                        <option value="right">å³å¯¹é½</option>
                    </select>
                </div>
                <div class="property-group">
                    <label>å­—ä½“æ ·å¼:</label>
                    <div style="display: flex; gap: 10px;">
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="boldInput">
                            åŠ ç²—
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- å›¾ç‰‡å…ƒç´ å±æ€§ -->
            <div id="imageProperties" class="element-properties" style="display: none;">
                <div class="property-group">
                    <label>å®½åº¦:</label>
                    <input type="number" id="imageWidthInput" value="100" min="50" max="300">
                </div>
                <div class="property-group">
                    <label>é«˜åº¦:</label>
                    <input type="number" id="imageHeightInput" value="100" min="50" max="300">
                </div>
                <div class="property-group">
                    <label>æ›¿æ¢å›¾ç‰‡:</label>
                    <input type="file" id="replaceImageInput" accept="image/*" style="display: none;">
                    <button id="replaceImageBtn" class="tool-btn">é€‰æ‹©æ–°å›¾ç‰‡</button>
                </div>
            </div>
            
            <div class="property-group">
                <button id="saveProps" class="tool-btn primary">ä¿å­˜</button>
                <button id="deleteElement" class="tool-btn danger">åˆ é™¤</button>
            </div>
        </div>

        <!-- æ‰“å°é¢„è§ˆæ¨¡æ€æ¡† -->
        <div class="print-preview" id="printPreview">
            <div class="print-preview-content">
                <h2>æ‰“å°é¢„è§ˆ</h2>
                <div id="previewContent"></div>
                <div style="margin-top: 20px; text-align: center;">
                    <button id="confirmPrint" class="editor-btn">æ‰“å°</button>
                    <button id="closePreview" class="editor-btn" style="background: #95a5a6;">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="script.js"></script>
    <script src="mobile-events.js"></script>
</body>
</html>